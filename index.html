<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style>
      font {
        font-family: Roboto;
        font-size: 12px;
        line-height: 16px;
      }
      #footer {
        padding: 10px;
        margin: 10px 0;
        cursor: pointer;
        background-color: tomato;
        color: white;
        display: inline-block;
      }
    </style>
  </head>
  <body>
    <form id="footer-select" autocomplete="on" onsubmit="dummySubmit(); return false;">
      <section id="product-select">
        <font>Select product : </font>
        <select name="products" id="products">
          <option value="" disabled selected>Select your option</option>
          <? for (var i = 0; i < data.products.length; i++) { ?>
            <option value="<?= data.products[i] ?>"><?= data.products[i] ?></option>
          <? } ?>
        </select>
      </section>
      <section id="offer-select">
        <font>Select offer type : </font>
        <!-- Append offer type dropdown here -->
      </section>
      <section id="lang-select">
        <font>Select language : </font>
        <!-- Append language dropdown here -->
      </section>
      <font id="footer">Show my footer</font>
      <section id="footer-content">
      </section>
    </form>
  </body>
</html>
<!-- Load JS last as per https://developers.google.com/apps-script/guides/html/best-practices -->
<!-- jQuery -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script>
  $( document ).ready(function() {
    // Hide offer type and language dropdowns on initial loading
    $("#offer-select").hide();
    $("#lang-select").hide();
  });
  function showOfferTypes(offerObj) {
    // Client side success handler
    // can only return a string
    // so it must be parsed first
    var offerTypes = JSON.parse(offerObj)[0];
    // Remove existing dropdown
    $("#offer-type").remove();
    $("#offer-select").show();
    // Create select/dropdown element
    var s = $("<select />", {name: "offerTypes", id : "offer-type"});
    // Add existing offer types
    for(var i in offerTypes) {
      $('<option />', {value: i, text: offerTypes[i]}).appendTo(s);
    }
    // Add the dropdown to the form
    s.appendTo("#offer-select");
  };
  function showLangs(langObj) {
    // Client side success handler
    // can only return a string
    // so it must be parsed first
    var langs = JSON.parse(langObj);
    // Remove existing dropdown
    $("#langs").remove();
    $("#lang-select").show();
    // Create select/dropdown element
    var s = $("<select />", {name: "langs", id : "langs"});
    // Add existing languages
    for(var i in langs) {
      $('<option />', {value: i, text: langs[i][0] + " - " + langs[i][1]}).appendTo(s);
    }
    // Add the dropdown to the form
    s.appendTo("#lang-select");
  };
  function showFooter(footerObj) {
    // Client side success handler
    // can only return a string
    // so it must be parsed first
    var footer = JSON.parse(footerObj);
    // Create filter for curly quotes, etc
    console.log(footer);
    $("#footer-content").text(footer);
  };
  // Look up offerTypes whenever product is changed
  $("#products").change(function() {
    // Hide offer and language dropdowns when product is updated
    $("#offer-select").hide();
    $("#lang-select").hide();
    // Get selected product
    var product = $("#products").val();
    // Get offer types for selected product
    google.script.run.withSuccessHandler(showOfferTypes).getOfferTypes(product);
    google.script.run.withSuccessHandler(showLangs).getLangs(product);
  });
  // Look up footer when CTA is clicked
  $("#footer").click(function() {
    // Intialize footer parameter object
    var footerParams = {};
    // Add footer parameters to object
    footerParams.product = $("#products").val();
    footerParams.offer = $("#offer-type").val();
    footerParams.lang = $("#langs").val();
    console.log(footerParams);
    // Get footer content using defined parameters
    google.script.run.withSuccessHandler(showFooter).getFooter(footerParams);
  });
</script>